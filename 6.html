<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>centos7配置反向代理 - 闹市无声</title><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" type="text/css" href="/style.css"></head><body><div class="header"><a href="/"><img src="/logo.png" alt="闹市无声"></a></div><div class="post"><h3>centos7配置反向代理</h3><p>1个ip有多个端口运行多个服务，都需要使用域名的80.443端口来进行访问，可以使用反向代理来实现</p><p>安装好nginx后，进入到etc/nginx/conf.d目录中，会发现有default.conf, 运行cp defaulut.conf google.com.conf 复制一份默认配置，以google.com为例，按需修改如下</p><code>server {<br>listen 80;<br>server_name google.com;<br>#access_log /var/log/nginx/host.access.log main;<br>location / {<br>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br>proxy_set_header Host $http_host;<br>proxy_set_header X-Real-IP $remote_addr;<br>proxy_redirect off;<br>proxy_pass http://127.0.0.1:55555;<br># 上传的最大文件尺寸<br>client_max_body_size 20000m;<br>}</code><p>配置好后，重新加载nginx配置</p><code>systemctl reload nginx</code><h4>禁用ip访问</h4><p>默认Nginx是允许ip访问的，但这样不安全</p><p>输入 cp default.conf default.conf1 命令或删掉 default.conf，来去掉 default.conf 配置</p><p>再输入 cp google.com.conf ip.500.conf 命令，复制一份，修改 ip.500.conf 配置，修改后如下</p><code>server {<br>listen 80 default;<br>return 500;<br>}</code><p>listen 80 default 后面加 default 说明默认这是一台虚拟主机，配合 return 500 ，当输入ip访问时，就会返回 500 错误，从而禁用了ip访问</p><p>注：这里是新建一份配置来做，不是在原来的配置上改</p><p>到此CentOS 7 安装 Nginx 配置反向代理基本完成</p><p>如果要配置第二个网站，复制份 google.com.conf 配置文件，把里面 server_name 和 proxy_pass 改成新的域名和转发的服务地址即可</p></div></body></html>
