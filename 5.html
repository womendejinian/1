<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>centos7开启bbr - 闹市无声</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/style.css"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"></head><body><div class="header"><a href="/"><img src="/logo.png" alt="闹市无声"></a></div><div class="post"><h3>centos7开启bbr</h3><p>查看内核版本，如果输出类似<br><br><code>uname -r</code><br><br><code>3.10.0-514.21.2.el7.x86_64</code><br><br>安装ELRepo仓库<br><br><code>rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</code><br><br><code>rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</code><br><br>安装最新版kernel<br><br><code>yum --enablerepo=elrepo-kernel install kernel-ml -y</code><br><br>确认是否安装成功<br><br><code>rpm -qa | grep kernel</code><br><br>如果输出类似如下，包含kernel-ml-5.16.12-1.el7.elrepo.x86_64或更高版本内核，则表示安装成功<br><br><code>kernel-3.10.0-693.el7.x86_64<br>kernel-tools-3.10.0-693.el7.x86_64<br>kernel-ml-5.16.12-1.el7.elrepo.x86_64<br>kernel-tools-libs-3.10.0-693.el7.x86_64</code><br><br>设置开机默认启动项，先执行下面代码<br><br><code>egrep ^menuentry /etc/grub2.cfg | cut -f 2 -d \'</code><br><br>输出结果类似如下<br><br><code>CentOS Linux 7 Rescue f212d2d7754a4a6bb2b98950c20cc0b5 (5.16.12-1.el7.elrepo.x86_64)<br>CentOS Linux (5.16.12-1.el7.elrepo.x86_64) 7 (Core)<br>CentOS Linux (3.10.0-693.el7.x86_64) 7 (Core)<br>CentOS Linux (0-rescue-d1f142097d497f24c021d7de9b81cab4) 7 (Core)</code><br><br>设置启动项<br><br>该列表从0开始索引，所以5.16内核索引为1<br><br><code>grub2-set-default 1</code><br><br>重启<br><br><code>reboot</code><br><br>查看内核版本<br><br><code>uname -r</code><br><br>如果输出类似<br><br>则表示升级完成<br><br><code>5.16.12-1.el7.elrepo.x86_64</code><br><br></p><h4>开启bbr</h4>修改sysctl配置<br><br><code>echo 'net.core.default_qdisc=fq' | tee -a /etc/sysctl.conf<br>echo 'net.ipv4.tcp_congestion_control=bbr' | tee -a /etc/sysctl.conf<br>sysctl -p</code><br><br>检查是否加载BBR<br><br><code>lsmod | grep bbr</code><br><br>如果输出结果包含tcp_bbr，则表示开启成功<br><br><code>tcp_bbr 20480 0</code></p></div></body></html>
